---
import Analytics from '@vercel/analytics/astro'
import  SpeedInsights  from "@vercel/speed-insights/astro"
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import SEOTags from '@/components/seo/SEOTags.astro';
import { ViewTransitions } from 'astro:transitions';

import '@fontsource/open-sans';
import '@/styles/tailwind.css';
import '@/styles/post.css';
import ThemeProvider from '@/components/ThemeProvider.astro';

export interface Props {
  title?: string;
  description?: string;
  keywords?: string[];
  noindex?: boolean;
  extraLinks?: { rel: string; href: string; type?: string; title?: string }[];
  extraMeta?: Record<string, string>[];
  og?: {
    title?: string;
    type?: string;
    description?: string;
    image?: string;
    alt?: string;
  };
  article?: {
    publishedTime?: string;
    modifiedTime?: string;
    author?: string;
    section?: string;
    tags?: string[];
  };
}

const { title, description, keywords, og, article, noindex, extraLinks = [], extraMeta = [] } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <SEOTags title={title} description={description} keywords={keywords} og={og} article={article} />

  <body class="relative min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950 text-slate-100 antialiased overflow-x-hidden">
    <ViewTransitions />
    <!-- Content wrapper with flexbox for sticky footer -->
    <div class="relative z-10 min-h-screen flex flex-col">
      <!-- Header -->
      <div class="sticky top-0 z-50 backdrop-blur-2xl bg-black/20 border-b border-white/10 shadow-2xl">
        <div class="mx-auto w-full max-w-7xl px-4 py-2 sm:px-6 sm:py-3 lg:px-8">
          <Header />
        </div>
      </div>
      
      <!-- Main content - flex-grow to push footer down -->
      <main class="relative flex-grow" transition:name="page">
        <div class="mx-auto w-full max-w-7xl px-4 lg:py-8 sm:px-6 lg:px-8">
          <slot />
        </div>
      </main>

      <!-- Footer - will stay at bottom when content is minimal -->
      <Footer />
    </div>
    
    <ThemeProvider />
    <Analytics />
    <SpeedInsights/>
    
    <style is:global>
      html {
        font-family: 'Inter', system-ui, sans-serif;
        scroll-behavior: smooth;
      }
      
      /* Gradient animation */
      @keyframes gradient {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      
      .animate-gradient {
        background-size: 400% 400%;
        animation: gradient 25s ease infinite;
      }

      /* Respect reduced motion in layout-specific animations */
      @media (prefers-reduced-motion: reduce) {
        .animate-gradient {
          animation: none !important;
        }
        .animate-pulse {
          animation: none !important;
        }
      }
      
      /* Custom floating orb animations */
      @keyframes float {
        0%, 100% { 
          transform: translateY(0px) scale(1);
          opacity: 0.15;
        }
        50% { 
          transform: translateY(-20px) scale(1.05);
          opacity: 0.25;
        }
      }
      
      .floating-orb {
        animation: float 6s ease-in-out infinite;
      }
      
      .floating-orb:nth-child(2) {
        animation-delay: 2s;
      }
      
      .floating-orb:nth-child(3) {
        animation-delay: 4s;
      }
      
      /* Improved focus styles */
      *:focus-visible {
        outline: 2px solid #3b82f6;
        outline-offset: 2px;
        border-radius: 4px;
      }
      
      /* Better text rendering */
      body {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
      }
      
      /* Prevent double-tap zoom on mobile */
      * {
        touch-action: manipulation;
      }
      
      /* Prevent text selection on buttons and interactive elements */
      button, a, [role="button"] {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }
      
      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      
      ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
      }
      
      ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #3b82f6, #8b5cf6);
        border-radius: 10px;
      }
      
      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #2563eb, #7c3aed);
      }
    </style>
  </body>
</html>