---
import { getCollection } from 'astro:content';

import Layout from '@/layouts/Layout.astro';
import HeroSection from '@/components/home/HeroSection.astro';
import ProjectsSection from '@/components/home/ProjectsSection.astro';
import LatestPostsSection from '@/components/home/LatestPostsSection.astro';
import PlannedPostsSection from '@/components/home/PlannedPostsSection.astro';
import ContactSection from '@/components/home/ContactSection.astro';
import convertAsteriskToStrongTag from '@/utils/convertAsteriskToStrongTag';

import presentation from '@/data/presentation';
import projects from '@/data/projects';

const allPosts = await getCollection('posts');

const posts = allPosts
  .filter((post) => !post.data.planned)
  .sort((a, b) => new Date(b.data.publishedAt).getTime() - new Date(a.data.publishedAt).getTime());

const plannedPosts = allPosts
  .filter((post) => post.data.planned)
  .sort((a, b) => new Date(b.data.publishedAt).getTime() - new Date(a.data.publishedAt).getTime());
---

<Layout title="Mahmudul Alam — Senior Software Engineer | TypeScript, React, Node.js" description="Senior Software Engineer building with TypeScript, React, Node.js, Python, Go, and AWS. Writing about web development, architecture, performance, and developer experience." keywords={["Senior Software Engineer","TypeScript","React","Node.js","Astro","Next.js","AWS","Python","Go","Bangladesh"]}>
  <section class="space-y-24">
    {
      /* Person JSON-LD for homepage */
    }
    <script type="application/ld+json" set:html={JSON.stringify({
      '@context': 'https://schema.org',
      '@type': 'Person',
      name: 'Mahmudul Alam',
      url: 'https://mahmudul.dev',
      email: presentation.mail,
      sameAs: presentation.socials?.map((s) => s.link).filter(Boolean) || [],
      jobTitle: 'Senior Software Engineer',
      description: presentation.description.replace(/<[^>]+>/g, ''),
    })} />
    <HeroSection
      displayNameHTML={'&lt;Mahmudul::Alam&gt;'}
      nativeName={"মাহমুদুল আলম"}
      descriptionHTML={convertAsteriskToStrongTag(presentation.description)}
    />

  

    <ProjectsSection projects={projects} />

    <LatestPostsSection posts={posts} />

    <PlannedPostsSection posts={plannedPosts} contactEmail={presentation.mail} />

    <ContactSection email={presentation.mail} />
  </section>
</Layout>
